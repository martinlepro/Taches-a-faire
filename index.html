<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ma To-Do List Gamifi√©e</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    
    <div class="container">
        <header>
            <div id="profile-display" onclick="toggleSection('profile-section-modal')">
                <span id="profile-icon" style="font-size: 24px;">üë§</span>
                <span id="level-display" class="badge level-badge">Niv. 0</span>
            </div>

            <h1>Ma To-Do List Gamifi√©e</h1>
            
            <button class="settings-btn" onclick="toggleSection('settings-menu')">
                <i class="fas fa-cog"></i>
            </button>
        </header>
        
        <div class="stats-panel">
            <p>S√©rie Actuelle : <span id="current-streak">0</span> üî•</p>
            <p>Record de S√©rie : <span id="max-streak">0</span> üëë</p>
            <p>Total Points : <span id="total-points">0</span> üåü</p>
        </div>
        
        <div id="tasks-screen" class="screen active-screen">
            <section class="task-input">
                <input type="text" id="new-task" placeholder="Ajouter une nouvelle t√¢che..." required>
                <select id="task-difficulty">
                    <option value="easy">Facile (+1pt)</option>
                    <option value="medium" selected>Moyen (+3pts)</option>
                    <option value="hard">Difficile (+5pts)</option>
                </select>

                <div class="task-options">
                    <label>
                        <input type="checkbox" id="is-recurring"> R√©curent
                    </label>

                    <div id="recurrence-options" style="display: none;">
                        Tous les <input type="number" id="recurrence-value" value="1" min="1" style="width: 40px;"> 
                        <select id="recurrence-type">
                            <option value="daily">jour(s)</option>
                            <option value="weekly">semaine(s)</option>
                            <option value="monthly">mois</option>
                            <option value="yearly">ann√©e(s)</option>
                        </select>
                    </div>
                    
                    <label>
                        Heure limite : <input type="time" id="due-time">
                    </label>
                </div>
                <button onclick="addTask()">Ajouter</button>
            </section>

            <section class="task-list">
                <h2>T√¢ches √† faire</h2>
                
                <div class="tasks-controls">
                    <button onclick="setTaskFilter('all')" id="filter-all" class="active">Toutes</button>
                    <button onclick="setTaskFilter('todo')" id="filter-todo">√Ä Faire Seulement</button>
                    <select onchange="setTaskSort(this.value)">
                        <option value="default">Trier par D√©faut</option>
                        <option value="difficulty">Difficult√©</option>
                        <option value="time">Urgence</option>
                    </select>
                </div>

                <ul id="tasks-list">
                    </ul>
            </section>
        </div>

        <section id="shop-section" class="screen hidden-screen">
            <h2>üõí Boutique d'Am√©liorations</h2>
            <p>D√©pensez vos points pour des r√©compenses et des cosm√©tiques !</p>
            <ul id="shop-items-list">
                </ul>
        </section>
        
        <section id="profile-section" class="screen hidden-screen">
            <h2>‚ú® Mon Profil</h2>
            <div class="profile-details">
                <span id="current-profile-icon" style="font-size: 3rem;">üë§</span>
                <p>Niveau : <strong id="profile-level">0</strong></p>
                <p>Points Totaux : <strong id="profile-points">0</strong></p>
                <p>Meilleure S√©rie : <strong id="profile-max-streak">0</strong> jours</p>
            </div>
            <button onclick="shareProfile()">Partager mon Profil ! üöÄ</button>
        </section>

        <section class="history-section screen hidden-screen" id="history-section">
            <h2>üìä Historique & Statistiques</h2>

            <div class="history-toggle">
                <button onclick="displayHistory('daily')">Jour</button>
                <button onclick="displayHistory('weekly')">Semaine</button>
                <button onclick="displayHistory('monthly')">Mois</button>
                <button onclick="displayHistory('yearly')">Ann√©e</button>
            </div>

            <h3>S√©ries de Victoires Pass√©es</h3>
            <ul id="streak-history-list"></ul>

            <h3>T√¢ches Archiv√©es</h3>
            <ul id="archive-list"></ul>
            
            <h3>Historique des Points (<span id="history-period-title">Jour</span>)</h3>
            <ul id="points-history-list"></ul>
        </section>


        <div id="settings-menu" class="settings-menu hidden">
            <h2>R√©glages de l'Application</h2>
            
            <div class="setting-item">
                <label for="haptics-toggle">Vibrations (Haptics)</label>
                <input type="checkbox" id="haptics-toggle" onchange="saveSettings()">
            </div>

            <div class="setting-item social-setting">
                <label for="social-share-toggle">Synchronisation Firebase</label>
                <input type="checkbox" id="social-share-toggle" onchange="saveSettings()">
                <p class="warning-text">‚ö†Ô∏è Active la synchronisation de vos t√¢ches sur Firebase.</p>
            </div>
            
            <h3>Sauvegarde et Restauration</h3>
            <button onclick="exportData()">Exporter les donn√©es (JSON) ‚¨áÔ∏è</button>
            <label for="import-file" class="button import-btn">Importer les donn√©es ‚¨ÜÔ∏è</label>
            <input type="file" id="import-file" accept=".json" onchange="importData(event)" style="display: none;">
        </div>
    </div>
    
    <nav class="bottom-nav">
        <button onclick="showScreen('tasks-screen', this)" class="active">
            <i class="fas fa-list-check"></i> T√¢ches
        </button>
        <button onclick="showScreen('shop-section', this)">
            <i class="fas fa-store"></i> Boutique
        </button>
        <button onclick="showScreen('history-section', this)">
            <i class="fas fa-chart-line"></i> Stats
        </button>
        <button onclick="showScreen('profile-section', this)">
            <i class="fas fa-user"></i> Profil
        </button>
        <button onclick="alert('Fonctionnalit√© Sociale √† venir !')">
            <i class="fas fa-users"></i> Social
        </button>
    </nav>
    
    <script>
        document.getElementById('is-recurring').addEventListener('change', function() {
            // Utiliser 'inline-flex' pour un meilleur alignement dans la balise input
            document.getElementById('recurrence-options').style.display = this.checked ? 'inline-flex' : 'none';
        });
    </script>

    <script type="module">
        const firebaseConfig = {
            apiKey: "AIzaSyAxwNs55WQQCTv0ShN_g4jb1_5PegPjgso",
            authDomain: "dino-meilleur-score-classement.firebaseapp.com",
            databaseURL: "https://dino-meilleur-score-classement-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "dino-meilleur-score-classement",
            storageBucket: "dino-meilleur-score-classement.firebasestorage.app",
            messagingSenderId: "879037843002",
            appId: "1:879037843002:web:a40483052bcb5e73fad703",
            measurementId: "G-HTR6QG5493"
        };

        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js";
        import { getDatabase, ref, set, onValue, push, remove } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-database.js";

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        window.db = db;
        window.ref = ref;
        window.set = set;
        window.onValue = onValue;
        window.push = push;
        window.remove = remove;
    </script>
    
    <script src="app.js"></script>
</body>
</html>
